@図形
--track0:位置 %,0,100,0
--track1:大きさ px,0,1000,100
--track2:縦横比 %,-100,100,0
--dialog:パスID,pathid="パス*";図形/fig,shape="三角形";色/col,color=0xffffff;進行方向を向く/chk,rotate=1

local pathlib = require("path")
local path = pathlib.getregpath(pathid)
if path then
  local x, y, dx, dy = path:getpt(obj.track0 / 100)
  local angle = rotate == 1 and math.deg(math.atan2(dx, -dy)) or 0
  obj.load("figure", shape, color, obj.track1)
  obj.aspect = obj.track2 / 100
  obj.effect()
  obj.draw(x, y, 0, 1, 1, 0, 0, angle)
  -- obj.ox, obj.oy, obj.rz = x, y, angle
end

